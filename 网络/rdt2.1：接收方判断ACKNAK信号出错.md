
引入0/1序号和丢弃分组，解决接收方判断ACK/NAK信号出错，导致发送分组重复问题。但这也让发送方和接收方有限状态机的状态翻倍。

## rdt2.1有限状态机

### 发送方

![在这里插入图片描述|675](https://img-blog.csdnimg.cn/223a83156826426a8f57bd03fd103bb9.png)

相较于rdt2.0，rdt2.1在发送的packet里包含了0/1序号（sequence number），所以发送方有4种状态——**等待上级调用 0**、**等待ACK或NAK 0**、**等待上级调用 1**、**等待ACK或NAK 1**。

### 接收方

![在这里插入图片描述|700](https://img-blog.csdnimg.cn/849319bde3244885bbbcead99f374e80.png)

接收方有2种状态——**等待下级调用 0**、**等待下级调用 1**。只有在数据包ACK且**收到的packet序号与目前状态等待的序号相同**时，才能向上传输。

![在这里插入图片描述|725](https://img-blog.csdnimg.cn/dcb4260d5454458a996854011bc2cceb.png)  

**为什么接收方等待1状态接收到0的packet时，为什么要反馈ACK？**  

为什么会收到零号的包，因为前一个零号状态的ack出错了，而我现在希望他发送一号的包，所以需要他结束0号的状态
